
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://example.com/getting-started/">
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../additional/configuration/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.13">
    
    
      
        <title>Getting started - EventFlow</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e359304.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#getting-started" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="EventFlow" class="md-header__button md-logo" aria-label="EventFlow" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EventFlow
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Getting started
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="EventFlow" class="md-nav__button md-logo" aria-label="EventFlow" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    EventFlow
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to EventFlow's documentation!
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example-application" class="md-nav__link">
    <span class="md-ellipsis">
      Example application
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aggregate-identity" class="md-nav__link">
    <span class="md-ellipsis">
      Aggregate identity
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aggregate" class="md-nav__link">
    <span class="md-ellipsis">
      Aggregate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#event" class="md-nav__link">
    <span class="md-ellipsis">
      Event
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command" class="md-nav__link">
    <span class="md-ellipsis">
      Command
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command-handler" class="md-nav__link">
    <span class="md-ellipsis">
      Command handler
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#read-model" class="md-nav__link">
    <span class="md-ellipsis">
      Read model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Next steps
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Additional
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Additional
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../additional/configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../additional/customize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Customize
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../additional/dos-and-donts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dos and don't
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../additional/faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../additional/snapshots/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Snapshots
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../additional/specifications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Specifications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../additional/value-objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Value objects
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Basics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Basics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basics/aggregates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aggregates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basics/commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basics/event-upgrade/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Event upgrade
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basics/identity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Identity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basics/jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jobs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basics/metadata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metadata
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basics/queries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Queries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basics/sagas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sagas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basics/subscribers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aggregates
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Integration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Integration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integration/event-stores/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integration/mongodb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MongoDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integration/mssql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microsoft SQL Server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integration/postgresql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PostgreSQL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integration/rabbitmq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RabbitMQ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integration/read-stores/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read stores
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../integration/redis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Redis
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example-application" class="md-nav__link">
    <span class="md-ellipsis">
      Example application
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aggregate-identity" class="md-nav__link">
    <span class="md-ellipsis">
      Aggregate identity
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aggregate" class="md-nav__link">
    <span class="md-ellipsis">
      Aggregate
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#event" class="md-nav__link">
    <span class="md-ellipsis">
      Event
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command" class="md-nav__link">
    <span class="md-ellipsis">
      Command
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#command-handler" class="md-nav__link">
    <span class="md-ellipsis">
      Command handler
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#read-model" class="md-nav__link">
    <span class="md-ellipsis">
      Read model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Next steps
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="getting-started">Getting started</h1>
<p>Initializing EventFlow always starts with an <code>EventFlowOptions.New</code> as this
performs the initial bootstrap and starts the fluent configuration API. The
very minimum initialization of EventFlow can be done in a single line, but
wouldn't serve any purpose as no domain has been configured.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kt">var</span><span class="w"> </span><span class="n">resolver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EventFlowOptions</span><span class="p">.</span><span class="n">New</span><span class="p">.</span><span class="n">CreateResolver</span><span class="p">();</span>
</code></pre></div></td></tr></table></div>
<p>The above line does configures several important defaults</p>
<ul>
<li>Custom internal IoC container</li>
<li>In-memory :ref:<code>event store &lt;eventstores&gt;</code></li>
<li>Console logger</li>
<li>A "null" snapshot store, that merely writes a warning if used (no need to
  do anything before going to production if you aren't planning to use
  snapshots)</li>
<li>And lastly, default implementations of all the internal parts of EventFlow</li>
</ul>
<p>.. IMPORTANT::
    If you're using ASP.NET Core, you should install the <strong><em>EventFlow.AspNetCore</em></strong> package and invoke
    <code>AddAspNetCoreMetadataProviders</code> in Startup.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">ConfigureServices</span><span class="p">(</span><span class="n">IServiceCollection</span><span class="w"> </span><span class="n">services</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">services</span><span class="p">.</span><span class="n">AddEventFlow</span><span class="p">(</span><span class="n">ef</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">ef</span><span class="p">.</span><span class="n">AddDefaults</span><span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="n">Startup</span><span class="p">).</span><span class="n">Assembly</span><span class="p">);</span>
<span class="w">    </span><span class="n">ef</span><span class="p">.</span><span class="n">AddAspNetCoreMetadataProviders</span><span class="p">();</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Before using EventFlow in a production environment, you should configure an
alternative <strong>event store</strong>, an alternative <strong>IoC container</strong> and another
<strong>logger</strong> that sends log messages to your production log store.</p>
<ul>
<li>:ref:<code>IoC container &lt;ioc-container&gt;</code></li>
<li>:ref:<code>Log &lt;log&gt;</code></li>
<li>:ref:<code>Event store &lt;eventstores&gt;</code></li>
<li>:ref:<code>Snapshots &lt;snapshots&gt;</code></li>
</ul>
</div>
<p>To start using EventFlow, a domain must be configured which consists of the
following parts</p>
<ul>
<li>:ref:<code>Aggregate &lt;aggregates&gt;</code></li>
<li>:ref:<code>Aggregate identity &lt;identity&gt;</code></li>
<li>:ref:<code>Aggregate events &lt;events&gt;</code></li>
<li>:ref:<code>Commands and command handlers &lt;commands&gt;</code> (optional, but highly recommended)</li>
</ul>
<p>In addition to the above, EventFlow provides several optional features. Whether
or not these features are utilized depends on the application in which
EventFlow is used.</p>
<ul>
<li>:ref:<code>Read models &lt;read-stores&gt;</code></li>
<li>:ref:<code>Subscribers &lt;subscribers&gt;</code></li>
<li>:ref:<code>Event upgraders &lt;event-upgrade&gt;</code></li>
<li>:ref:<code>Queries &lt;queries&gt;</code></li>
<li>:ref:<code>Jobs &lt;jobs&gt;</code></li>
<li>:ref:<code>Snapshots &lt;snapshots&gt;</code></li>
<li>:ref:<code>Sagas &lt;sagas&gt;</code></li>
<li>:ref:<code>Metadata providers &lt;metadata-providers&gt;</code></li>
</ul>
<h2 id="example-application">Example application</h2>
<p>The example application includes one of each of the required parts: aggregate,
event, aggregate identity, command and a command handler. Further down we will
go through each of the individual parts.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The example code provided here is located within the EventFlow code base
exactly as shown, so if you would like to debug and step through the
entire flow, checkout the code and execute the <code>GettingStartedExample</code>
test.</p>
<p>https://github.com/eventflow/Documentation/tree/master/Source/EventFlow.Documentation/GettingStarted</p>
</div>
<p>All classes create for the example application are prefixed with <code>Example</code>.</p>
<p>.. literalinclude:: ../Source/EventFlow.Documentation/GettingStarted/ExampleTests.cs
  :linenos:
  :dedent: 12
  :language: c#
  :lines: 38-75</p>
<p>The above example publishes the <code>ExampleCommand</code> to the aggregate with the
<code>exampleId</code> identity with the magical value of <code>42</code>. After the command has
been published, the accompanying read model <code>ExampleReadModel</code> is fetched
and we verify that the magical number has reached it.</p>
<p>During the execution of the example application, a single event is emitted and
stored in the in-memory event store. The JSON for the event is shown here.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;MagicNumber&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">42</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>The event data itself is straightforward as it is merely the JSON serialization of
an instance of the type <code>ExampleEvent</code> with the value we defined. A bit more
interesting is the metadata that EventFlow stores alongside the event, which is
used by the EventFlow event store.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2016-11-09T20:56:28.5019198+01:00&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;aggregate_sequence_number&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;aggregate_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ExampleAggrenate&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;aggregate_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;example-c1d4a2b1-c75b-4c53-ae44-e67ee1ddfd79&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;event_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;event-d5622eaa-d1d3-5f57-8023-4b97fabace90&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;timestamp_epoch&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1478721389&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;batch_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;52e9d7e9-3a98-44c5-926a-fc416e20556c&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;source_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;command-69176516-07b7-4142-beaf-dba82586152c&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;event_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;example&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;event_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1&quot;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>All the built-in metadata is available on each instance of <code>IDomainEvent&lt;,,&gt;</code>,
which is accessible from event handlers for e.g. read models or subscribers. It is
also possible to create your own :ref:<code>metadata providers &lt;metadata-providers-custom&gt;</code>
or add additional EventFlow built-in providers as needed.</p>
<h2 id="aggregate-identity">Aggregate identity</h2>
<p>The aggregate ID in EventFlow is represented as a value object that inherits
from the <code>IIdentity</code> interface. You can provide your own implementation, but
EventFlow provides a convenient implementation that will suit most needs.  Be
sure to read the section about the :ref:<code>Identity\&lt;\&gt; &lt;identity&gt;</code> class
for details on how to use it.</p>
<p>For our example application we use the built-in class, which makes the implementation
very simple.</p>
<p>.. literalinclude:: ../Source/EventFlow.Documentation/GettingStarted/ExampleId.cs
  :linenos:
  :dedent: 4
  :language: c#
  :lines: 29-34</p>
<h2 id="aggregate">Aggregate</h2>
<p>Now we'll take a look at the <code>ExampleAggregate</code>. It is rather simple as the
only thing it can do is apply the magic number once.</p>
<p>.. literalinclude:: ../Source/EventFlow.Documentation/GettingStarted/ExampleAggregate.cs
  :linenos:
  :dedent: 4
  :language: c#
  :lines: 30-55</p>
<p>Be sure to read the section on :ref:<code>aggregates &lt;aggregates&gt;</code> to get all the
details right. For now the most important thing to note, is that the state
of the aggregate (updating the <code>_magicNumber</code> variable) happens in the
<code>Apply(ExampleEvent)</code> method. This is the event sourcing part of EventFlow in
effect. As state changes are only saved as events, mutating the aggregate state
must happen in such a way that the state changes are replayed the next time the
aggregate is loaded. EventFlow has a :ref:<code>set of different approaches &lt;aggregates_applying_events&gt;</code>
that you can select from. In this example we use the <code>Apply</code> methods as
they are the simplest.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>The <code>Apply(ExampleEvent)</code> is invoked by the <code>Emit(...)</code> method, so
after the event has been emitted, the aggregate state has changed.</p>
</div>
<p>The <code>ExampleAggregate</code> exposes the <code>SetMagicNumer(int)</code> method, which
is used to expose the business rules for changing the magic number. If the
magic number hasn't been set before, the event <code>ExampleEvent</code> is emitted
and the aggregate state is mutated.</p>
<p>If the magic numer was changed, we return a failed <code>IExecutionResult</code> with
an error message. Returning a failed execution result will make EventFlow
disregard any events the aggregate has emitted.</p>
<p>If you need to return something more useful than a <code>bool</code> in an execution
result, merely create a new class that implements the <code>IExecutionResult</code>
interface and specific the type as generic arguments for the command and
command handler.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While possible, do not use the execution results as a method of reading
values from the aggregate, that's what the <code>IQueryProcessor</code> and
read models are for.</p>
</div>
<h2 id="event">Event</h2>
<p>Next up is the event which represents something that <strong>has</strong> happened in our domain.
In this example, it's merely that some magic number has been set. Normally
these events should have a really, really good name and represent something in the
ubiquitous language for the domain.</p>
<p>.. literalinclude:: ../Source/EventFlow.Documentation/GettingStarted/ExampleEvent.cs
  :linenos:
  :dedent: 4
  :language: c#
  :lines: 30-41</p>
<p>We have applied the <code>[EventVersion("example", 1)]</code> to our event, marking it
as the <code>example</code> event version <code>1</code>, which directly corresponds to the
<code>event_name</code> and <code>event_version</code> from the metadata store along side the
event mentioned. The information is used by EventFlow to tie the name and version to
a specific .NET type.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Even though the using the <code>EventVersion</code> attribute is optional, it is
<strong>highly recommended</strong>. EventFlow will infer the information if it isn't
provided, thus making it vulnerable to type renames among other things.</p>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Once you have aggregates in your production environment that have emitted
an event, you should never change the .NET implementation. You can deprecate
it, but you should never change the type or the data stored in the event
store.</p>
</div>
<h2 id="command">Command</h2>
<p>Commands are the entry point to the domain and if you remember from the example
application, they are published using the <code>ICommandBus</code> as shown here.</p>
<p>.. literalinclude:: ../Source/EventFlow.Documentation/GettingStarted/ExampleTests.cs
  :linenos:
  :dedent: 16
  :language: c#
  :lines: 55-59</p>
<p>In EventFlow commands are simple value objects that merely house the arguments for
the command execution. All commands implement the <code>ICommand&lt;,&gt;</code> interface, but
EventFlow provides an easy-to-use base class that you can use.</p>
<p>.. literalinclude:: ../Source/EventFlow.Documentation/GettingStarted/ExampleCommand.cs
  :linenos:
  :dedent: 4
  :language: c#
  :lines: 29-42</p>
<p>A command doesn't do anything without a command handler. In fact, EventFlow
will throw an exception if a command doesn't have exactly <strong>one</strong> command
handler registered.</p>
<h2 id="command-handler">Command handler</h2>
<p>The command handler provides the glue between the command, the aggregate and
the IoC container as it defines how a command is executed. Typically they are
rather simple, but they could contain more complex logic. How much is up to you.</p>
<p>.. literalinclude:: ../Source/EventFlow.Documentation/GettingStarted/ExampleCommandHandler.cs
  :linenos:
  :dedent: 4
  :language: c#
  :lines: 31-43</p>
<p>The <code>ExampleCommandHandler</code> in our case here merely invokes the
<code>SetMagicNumer</code> on the aggregate and returns the execution result. Remember, if
a command handler returns a failed execution result, EventFlow will disregard any
events the aggregate has emitted.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Everything inside the <code>ExecuteAsync(...)</code> method of a command handler
<strong>may</strong> be executed more than once if there's an optimistic concurrency
exception, i.e., something else has happened to the aggregate since it
as loaded from the event store and its therefor automatically reloaded by
EventFlow. It is therefor essential that the command handler doesn't mutate
anything other than the aggregate.</p>
</div>
<h2 id="read-model">Read model</h2>
<p>If you ever need to access the data in your aggregates efficiently, its important
that :ref:<code>read models &lt;read-stores&gt;</code> are used. Loading aggregates from the
event store takes time and its impossible to query for e.g. aggregates that have
a specific value in its state.</p>
<p>In our example we merely use the built-in in-memory read model store. It is useful
in many cases, e.g. executing automated domain tests in a CI build.</p>
<p>.. literalinclude:: ../Source/EventFlow.Documentation/GettingStarted/ExampleReadModel.cs
  :linenos:
  :dedent: 4
  :language: c#
  :lines: 30-43</p>
<p>Notice the <code>IDomainEvent&lt;ExampleAggrenate, ExampleId, ExampleEvent&gt; domainEvent</code>
argument. It's merely a wrapper around the specific event we implemented
earlier. The <code>IDomainEvent&lt;,,&gt;</code> provides additional information, e.g. any
metadata stored alongside the event.</p>
<p>The main difference between the event instance emitted in the aggregate and the
instance wrapped here, is that the event has been committed to the event store.</p>
<h2 id="next-steps">Next steps</h2>
<p>Although the implementation in this guide enables you to create a complete
application, there are several topics that are recommended as next steps.</p>
<ul>
<li>Read the :ref:<code>dos and donts &lt;dos-and-donts&gt;</code> section</li>
<li>Use :ref:<code>value objects &lt;value-objects&gt;</code> to produce cleaner JSON</li>
<li>If your application need to act on an emitted event, create a
   :ref:<code>subscriber &lt;subscribers&gt;</code></li>
<li>Check the :ref:<code>configuration &lt;configuration&gt;</code> to make sure everything
   is as you would like it</li>
<li>Setup a persistent event store using e.g.
   :ref:<code>Microsoft SQL Server &lt;eventstore-mssql&gt;</code></li>
<li>Create :ref:<code>read models &lt;read-stores&gt;</code> for efficient querying</li>
<li>Consider the use of :ref:<code>specifications &lt;specifications&gt;</code> to ease
   creation of business rules</li>
</ul>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8d2eff1.min.js"></script>
      
    
  </body>
</html>